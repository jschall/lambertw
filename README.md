Efficient, clean, short and readable, embedded-suitable C implementation of Lambert W function (generated by grok), with unit test against existing C++ implementation.
========

The entirety of this implementation is as follows:
```
float lambert_w0(float x) {
    const float INV_E = 0.36787944117f;
    if (x < -INV_E) {
        return NAN;
    }
    float w = x;
    for (int i = 0; i < 17; i++) {
        float ew = expf(w);
        float f = w * ew - x;
        float fp = ew * (1.0f + w);
        float fpp = ew * (2.0f + w);
        float num = 2.0f * f * fp;
        float den = 2.0f * fp * fp - f * fpp;
        if (den != 0.0f) {
            w -= num / den;
        }
    }
    return w;
}

float lambert_wm1(float y) {
    const float INV_E = 0.36787944117f;
    if (y < -INV_E || y >= 0.0f) {
        return NAN;
    }
    float x = logf(-y);
    int i;
    for (i = 0; i < 7; i++) {
        float ex = expf(x);
        if (ex == 0.0f) break;
        float f = x * ex - y;
        float fp = ex * (1.0f + x);
        float fpp = ex * (2.0f + x);
        float num = 2.0f * f * fp;
        float den = 2.0f * fp * fp - f * fpp;
        if (den != 0.0f) {
            x -= num / den;
        }
    }
    return x;
}
```

I release the above excerpt and the entirety of lambw_grok.h into the public domain. Any other content in this repository (a fork of DarkoVeberic/LambertW) may be subject to other licensing.

What follows is the entire readme for DarkoVeberic/LambertW

LambertW
========

C++ implementation of the Lambert W(x) function.

The implementation grew out of the code that was first used in the mathematical
utilities of the [Offline Reconstruction Software
Framework](http://arxiv.org/abs/0707.1652) of the [Pierre Auger
Observatory](http://www.auger.org).

The work is described in the following publications:
* [arXiv:1003.1628](http://arxiv.org/abs/1003.1628)
* [arXiv:1209.0735](http://arxiv.org/abs/1209.0735) and [Comp. Phys. Comm. **183** (2012) 2622-2628](http://dx.doi.org/10.1016/j.cpc.2012.07.008)

This is currently the fastest known implementation of the Lambert W function on the planet.


## License

Released under dual licence: the GPL version 2 and the two-clause BSD license.

Scientific or technical publications resulting from projects using this code are kindly requested to add the [Comp. Phys. Comm. **183** (2012) 2622-2628](http://dx.doi.org/10.1016/j.cpc.2012.07.008) citation among their references.



## Usage

All the relevant code is placed into an `utl` namespace.

The two branches (0 and -1) of the Lambert function can be specified as template parameters, e.g.
```C++
const double w = utl::LambertW<-1>(x);
```
or as normal parameters
```C++
const double w = utl::LambertW(-1, x);
```
